<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Manuten√ß√£o Ar-Condicionado</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f4f6;
    margin: 0;
}
.container {
    max-width: 800px;
    margin: auto;
    background: #fff;
    padding: 20px;
}
h1, h2 {
    text-align: center;
    color: #1e3a5f;
}
button {
    width: 100%;
    padding: 14px;
    margin: 8px 0;
    font-size: 16px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
}
.btn-cliente { background: #2ecc71; color: #fff; }
.btn-tecnico { background: #3498db; color: #fff; }

.box { display: none; margin-top: 20px; }
input, textarea { width: 100%; padding: 8px; margin: 5px 0; }
.footer { text-align: center; font-size: 12px; color: #777; margin-top: 25px; }
</style>
</head>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDD2Ydr3Z5gahJ11SfRlFMYn9OCVJ4XJQE",
  authDomain: "manutencaodear-5a2fb.firebaseapp.com",
  projectId: "manutencaodear-5a2fb"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
</script>
<body>

<div class="container">
<h1>üì≤ Manuten√ß√£o do Equipamento</h1>

<div id="equipamentoInfo"></div>

<button class="btn-cliente" onclick="mostrarCliente()">üë§ √Årea do Cliente</button>
<button class="btn-tecnico" onclick="salvarManutencao()">
  Salvar Manuten√ß√£o
</button>


<!-- CLIENTE -->
<div id="cliente" class="box">
<h2>Dados do Equipamento</h2>
<p><strong>Modelo:</strong> <span id="modelo"></span></p>
<p><strong>N¬∫ de S√©rie:</strong> <span id="serie"></span></p>
<p><strong>√öltima Manuten√ß√£o:</strong> <span id="ultima"></span></p>
<p><strong>Pr√≥xima Manuten√ß√£o:</strong> <span id="proxima"></span></p>
<p><strong>Local:</strong> <span id="local"></span></p>
</div>

<!-- LOGIN -->
<div id="login" class="box">
<h2>Login T√©cnico</h2>
<input type="password" id="senha" placeholder="Senha do t√©cnico">
<button class="btn-tecnico" onclick="validarSenha()">Entrar</button>
<p id="erro" style="color:red;"></p>
</div>

<!-- T√âCNICO -->
<div id="tecnico" class="box">
<h2>Registro T√©cnico</h2>
<input type="date">
<textarea rows="3" placeholder="Servi√ßo realizado"></textarea>
<textarea rows="2" placeholder="Pe√ßas substitu√≠das"></textarea>
<textarea rows="3" placeholder="Observa√ß√µes t√©cnicas"></textarea>
<button class="btn-tecnico">Salvar (visual)</button>
</div>
<input type="date" id="data">
<input type="text" id="tecnico" placeholder="Nome do t√©cnico">

<textarea id="servico" placeholder="Servi√ßo realizado"></textarea>
<textarea id="observacoes" placeholder="Observa√ß√µes"></textarea>

<div class="footer">
Sistema de manuten√ß√£o por QR Code
</div>
</div>

<script>
function salvarManutencao() {
    console.log("Bot√£o clicado"); // DEBUG

    const data = document.getElementById("data").value;
    const tecnico = document.getElementById("tecnico").value;
    const servico = document.getElementById("servico").value;
    const observacoes = document.getElementById("observacoes").value;

    if (!data || !tecnico || !servico) {
        alert("Preencha todos os campos obrigat√≥rios");
        return;
    }

    db.collection("equipamentos")
      .doc(eq) // vem do QR Code ?eq=001
      .collection("historico")
      .add({
          data: data,
          tecnico: tecnico,
          servico: servico,
          observacoes: observacoes,
          criadoEm: new Date()
      })
      .then(() => {
          alert("‚úÖ Manuten√ß√£o salva!");
          carregarHistorico(); // atualiza lista
      })
      .catch((error) => {
          alert("‚ùå Erro ao salvar");
          console.error(error);
      });
}
// "Banco de dados" simples
const equipamentos = {
    "001": {
        modelo: "Split 12.000 BTUs",
        serie: "AC001",
        ultima: "10/01/2026",
        proxima: "10/07/2026",
        local: "Sala 01"
    },
    "002": {
        modelo: "Split 18.000 BTUs",
        serie: "AC002",
        ultima: "05/12/2025",
        proxima: "05/06/2026",
        local: "luiz claudio Belvedere"
    },
    
    "003": {
        modelo: "Cassete 24.000 BTUs",
        serie: "AC003",
        ultima: "20/11/2025",
        proxima: "20/05/2026",
        local: "Audit√≥rio"
    }
};

// L√™ o c√≥digo do equipamento da URL
const params = new URLSearchParams(window.location.search);
const eq = params.get("eq");

// Carrega dados
if (eq && equipamentos[eq]) {
    const e = equipamentos[eq];
    document.getElementById("modelo").innerText = e.modelo;
    document.getElementById("serie").innerText = e.serie;
    document.getElementById("ultima").innerText = e.ultima;
    document.getElementById("proxima").innerText = e.proxima;
    document.getElementById("local").innerText = e.local;
} else {
    document.getElementById("equipamentoInfo").innerHTML =
        "<p style='color:red;text-align:center;'>Equipamento n√£o identificado</p>";
}

// Fun√ß√µes de tela
function mostrarCliente() {
    esconderTudo();
    document.getElementById("cliente").style.display = "block";
}
function mostrarLogin() {
    esconderTudo();
    document.getElementById("login").style.display = "block";
}
function validarSenha() {
    if (document.getElementById("senha").value === "211710") {
        esconderTudo();
        document.getElementById("tecnico").style.display = "block";
    } else {
        document.getElementById("erro").innerText = "Senha incorreta";
    }
}
function esconderTudo() {
    ["cliente","login","tecnico"].forEach(id => {
        document.getElementById(id).style.display = "none";
    });
}
</script>

</body>
</html>
